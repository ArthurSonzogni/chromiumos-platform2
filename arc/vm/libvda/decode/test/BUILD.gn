# Copyright 2023 The ChromiumOS Authors
# Use of this source code is governed by a BSD-style license that can be
# found in the LICENSE file.

group("all") {
  deps = [ ":libvda_gpu_unittest" ]
}

# Unit tests for the GPU VDA impl, to be executed by tast tests.
executable("libvda_gpu_unittest") {
  install_path = "/usr/libexec/libvda-gpu-tests"
  sources = [
    "../../decode_gpu_test.cc",
    "decode_event_thread.cc",
    "decode_unittest_common.cc",
    "encoded_data_helper.cc",
  ]

  # Need to define UNIT_TEST for ShadowingAtExitManager.
  defines = [ "UNIT_TEST" ]
  ldflags = [ "-pthread" ]
  configs += [ "//common-mk:test" ]
  libs = [ "pthread" ]
  pkg_deps = [
    "gbm",
    "libchrome-test",
  ]
  deps = [ "//arc/vm/libvda:libvda_source_set" ]
}
