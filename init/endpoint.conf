# Start IxChariot Endpoint
# Start after iptables has been configured so that the following will not get overwritten.
start on stopped iptables and stopped ip6tables and starting failsafe

pre-start script
	# Don't change iptables if the endpoint file is not installed.
	if [! -e /usr/local/Ixia/endpoint]; then
	        stop;
		exit 0;
	fi
	# This lets the endpoint receive commands from the console.
	iptables -A INPUT -p tcp -m tcp --dport 10115 -j ACCEPT

	# This lets this endpoint accept traffic from another endpoint on port 10120.
	iptables -A INPUT -p tcp -m tcp --dport 10120 -j ACCEPT
	iptables -A INPUT -p udp -m udp --dport 10120 -j ACCEPT
end script

exec /usr/local/Ixia/endpoint
