# Copyright (c) 2010 The Chromium OS Authors. All rights reserved.
# Use of this source code is governed by a BSD-style license that can be
# found in the LICENSE file.

description   "Run candidate_window for IBus"
author        "chromium-os-dev@googlegroups.com"

start on login-prompt-ready
stop on stopping ui
respawn

# TODO(yusukes): Add logging option.
env XAUTHORITY=/home/chronos/.Xauthority
env DISPLAY=:0.0
env MINIJAIL_FLAGS="--use-capabilities"
# might be overridden by --uid parameter in /sbin/session_manager_setup.sh
env USER_ID=1000
env HOME=/home/chronos
# By default, libdbus treats all warnings as fatal errors. That's too strict.
env DBUS_FATAL_WARNINGS=0

script
export USERHELPER_UID=${USER_ID}

# Enable the crash dumper.
export LD_PRELOAD=/usr/lib/libcrash.so
exec /sbin/minijail ${MINIJAIL_FLAGS} --uid=${USER_ID} -- \
  /opt/google/chrome/candidate_window
end script
