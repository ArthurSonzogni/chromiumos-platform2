# Copyright (c) 2009 The Chromium OS Authors. All rights reserved.
# Use of this source code is governed by a BSD-style license that can be
# found in the LICENSE file.

# flimflam
#
# starts flimflam once wpasupplicant has been started.

start on started wpasupplicant

pre-start script
    if [ -e /mnt/stateful_partition/.recovery ]; then
      echo "`date`: Recovery boot. Not start flimflam" >> /var/log/recovery.log
      sleep 365d  # sleep for a long time
    fi
end script

respawn
expect fork
# -P dhclient: exclude dhclient so we use dhpcd
# -W nl80211: use nl80211 instead of wext
exec /usr/sbin/flimflamd -P dhclient -W nl80211
