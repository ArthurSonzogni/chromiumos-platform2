#!/bin/sh

# Copyright (c) 2012 The Chromium OS Authors. All rights reserved.
# Use of this source code is governed by a BSD-style license that can be
# found in the LICENSE file.

# This script is called after an AutoUpdate or USB install. This script is a
# simple wrapper that performs the minimal setup necessary to run
# chromeos-chroot-postinst inside an install root chroot.

INSTALL_ROOT=$(dirname "$0")

#
# /proc/cmdline is expected to contain exactly one of:
#   cros_secure, cros_legacy, or cros_efi
#

ARG=""
if [ -z "$(/bin/grep "cros_secure" /proc/cmdline)" ]; then
  ARG="--legacy"
fi

${INSTALL_ROOT}/usr/bin/cros_installer postinst ${ARG} "${INSTALL_ROOT}" $@
