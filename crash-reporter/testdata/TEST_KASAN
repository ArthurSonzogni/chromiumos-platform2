[   79.065672] lkdtm: Performing direct entry READ_AFTER_FREE
[   79.065809] lkdtm: Value in memory before free: 12345678
[   79.065848] lkdtm: Attempting bad read from freed memory
[   79.065868] ==================================================================
[   79.065901] BUG: KASAN: slab-use-after-free in lkdtm_READ_AFTER_FREE+0x214/0x220
[   79.065939] Read of size 4 at addr ffff8881143a9810 by task bash/5320

[   79.065992] CPU: 0 PID: 5320 Comm: bash Tainted: G     U             6.6.99-kasan-lockdep-08987-g33318fe92a65 #1 0ca2767c6653d594af11243f58d688481752f0dd
[   79.066027] Hardware name: Google Crota/Crota, BIOS Google_Crota.16425.0.0 09/19/2025
[   79.066046] Call Trace:
[   79.066065]  <TASK>
[   79.066083]  dump_stack_lvl+0x69/0xa0
[   79.066105]  print_address_description+0x51/0x1e0
[   79.066139]  print_report+0x4e/0x60
[   79.066159]  kasan_report+0x106/0x140
[   79.066179]  ? lkdtm_READ_AFTER_FREE+0x214/0x220
[   79.066214]  lkdtm_READ_AFTER_FREE+0x214/0x220
[   79.066233]  lkdtm_do_action+0x40/0x60
[   79.066267]  direct_entry+0x21c/0x270
[   79.066287]  full_proxy_write+0xe5/0x170
[   79.066307]  __x64_sys_write+0x2c3/0xc50
[   79.066341]  ? ktime_get_coarse_real_ts64+0xd7/0x180
[   79.066362]  ? ktime_get_coarse_real_ts64+0xd7/0x180
[   79.066397]  do_syscall_64+0x6b/0xa0
[   79.066417]  ? exc_page_fault+0x8e/0xf0
[   79.066436]  ? lockdep_hardirqs_on+0x9d/0x150
[   79.066470]  ? exc_page_fault+0x8e/0xf0
[   79.066489]  entry_SYSCALL_64_after_hwframe+0x73/0xdd
[   79.066524] RIP: 0033:0x7925e4dff972
[   79.066544] Code: 48 89 e5 53 48 83 ec 08 64 48 8b 1c 25 10 00 00 00 8b 83 08 03 00 00 80 3d 9a 47 15 00 00 75 04 a8 01 74 14 48 8b 45 10 0f 05 <48> 8b 5d f8 c9 c3 0f 1f 84 00 00 00 00 00 a8 10 75 e8 41 51 4c 8d
[   79.066592] RSP: 002b:00007fff1628f790 EFLAGS: 00000202 ORIG_RAX: 0000000000000001
[   79.066614] RAX: ffffffffffffffda RBX: 00007925e4d4a740 RCX: 00007925e4dff972
[   79.066648] RDX: 0000000000000010 RSI: 0000578cd38a67f0 RDI: 0000000000000001
[   79.066682] RBP: 00007fff1628f7a0 R08: 0000000000000000 R09: 0000000000000000
[   79.066702] R10: 0000000000000000 R11: 0000000000000202 R12: 0000000000000010
[   79.066736] R13: 0000578cd38a67f0 R14: 00007925e4f4d5c0 R15: 00007925e4f4aea0
[   79.066773]  </TASK>

[   79.066811] Allocated by task 5320:
[   79.066831]  stack_trace_save+0x4b/0x70
[   79.066868]  kasan_set_track+0x4d/0x80
[   79.066889]  __kasan_kmalloc+0x75/0x90
[   79.066909]  lkdtm_READ_AFTER_FREE+0x50/0x220
[   79.066944]  lkdtm_do_action+0x40/0x60
[   79.066965]  direct_entry+0x21c/0x270
[   79.066985]  full_proxy_write+0xe5/0x170
[   79.067020]  __x64_sys_write+0x2c3/0xc50
[   79.067041]  do_syscall_64+0x6b/0xa0
[   79.067061]  entry_SYSCALL_64_after_hwframe+0x73/0xdd

[   79.067116] Freed by task 5320:
[   79.067136]  stack_trace_save+0x4b/0x70
[   79.067171]  kasan_set_track+0x4d/0x80
[   79.067191]  kasan_save_free_info+0x2e/0x50
[   79.067211]  ____kasan_slab_free+0xf7/0x170
[   79.067247]  __kmem_cache_free+0xf2/0x950
[   79.067267]  lkdtm_READ_AFTER_FREE+0x112/0x220
[   79.067301]  lkdtm_do_action+0x40/0x60
[   79.067320]  direct_entry+0x21c/0x270
[   79.067340]  full_proxy_write+0xe5/0x170
[   79.067374]  __x64_sys_write+0x2c3/0xc50
[   79.067394]  do_syscall_64+0x6b/0xa0
[   79.067414]  entry_SYSCALL_64_after_hwframe+0x73/0xdd

[   79.067468] The buggy address belongs to the object at ffff8881143a9800
                which belongs to the cache kmalloc-1k of size 1024
[   79.067503] The buggy address is located 16 bytes inside of
                freed 1024-byte region [ffff8881143a9800, ffff8881143a9c00)

[   79.067558] The buggy address belongs to the physical page:
[   79.067593] page:000000006bb0be1e refcount:1 mapcount:0 mapping:0000000000000000 index:0x0 pfn:0x1143a8
[   79.067629] head:000000006bb0be1e order:3 entire_mapcount:0 nr_pages_mapped:0 pincount:0
[   79.067664] flags: 0x8000000000000840(slab|head|zone=2)
[   79.067685] page_type: 0xffffffff()
[   79.067705] raw: 8000000000000840 ffff88810004d600 ffffea00096d3a00 dead000000000002
[   79.067740] raw: 0000000000000000 0000000080100010 00000001ffffffff 0000000000000000
[   79.067774] page dumped because: kasan: bad access detected

[   79.067812] Memory state around the buggy address:
[   79.067847]  ffff8881143a9700: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc
[   79.067881]  ffff8881143a9780: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc
[   79.067901] >ffff8881143a9800: fa fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
[   79.067935]                          ^
[   79.067954]  ffff8881143a9880: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
[   79.067989]  ffff8881143a9900: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
[   79.068023] ==================================================================
[   79.068052] Disabling lock debugging due to kernel taint
