% minijail-config-file v0

# Copyright 2023 The ChromiumOS Authors
# Use of this source code is governed by a BSD-style license that can be
# found in the LICENSE file.

# Minijail settings:
# -G to be in policy-readers group to access /var/lib/devicesettings
# -u run as user flex_hwis
# -g run as group flex_hwis
# -S apply seccomp filters

# Namespaces:
# --profile=minimalistic-mountns mount namespace with basic mounts

# -e enter new network namespace
# -l enter a new IPC namespace
# -p enter new pid namespace
# -N enter a new cgroup namesapce

# Mounts:
# -k to mount tmpfs at /run and /var
# -b /var/lib/metrics to enable UMA
# -b /var/lib/devicesettings to load policy
# -b /var/lib/flex_hwis_tool to access flex_hwis data

# For DBUS
# -b /run/dbus

# For mojo
# -b /run/mojo

e
l
N
p
uts
profile=minimalistic-mountns
S = /usr/share/policy/flex_hwis-seccomp.policy
u = flex_hwis
g = flex_hwis
G
mount = /run,/run,tmpfs,MS_NODEV|MS_NOEXEC|MS_NOSUID,mode=755,size=10M
mount = /var,/var,tmpfs,MS_NODEV|MS_NOEXEC|MS_NOSUID,mode=755,size=10M
bind-mount = /var/lib/metrics,,1
bind-mount = /var/lib/devicesettings,,1
bind-mount = /var/lib/flex_hwis_tool,,1
bind-mount = /run/dbus
bind-mount = /run/mojo,,1