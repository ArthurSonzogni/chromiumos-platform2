% minijail-config-file v0

# Need -G to be in video group to access /dev/video*.
# Need access to original network namespace for udev (no -e), which passes
# uevents via netlink socket.
# Write PID to /sys/fs/cgroup/cpuset/user_space/media/tasks.
#
# Need (executable) access to /run/imageloader to read DLC.
#
# Need access to /proc, /sys, /dev to perform USB enumeration.
# Need access to /var/cache/camera to read camera parameters.
# Need access to /var/lib/timezone to read correct timezone.
# Need access to /var/lib/ml_core/opencl_cache to read effects opencl cache.
# Need read access to /run/chromeos-config/v1 for access to chromeos-config.
# Need (writable) access to /dev/shm to share memory with Android.
# Need (writable) access to /var/lib/metrics to log metrics.
# Need (writable) access to /run/dbus for DBus communications.
#
# Set RLIMIT_NICE(=13) to 40,40

i
u = arc-camera
g = arc-camera
G
N
p
r
l
t
f = /sys/fs/cgroup/cpuset/user_space/media/tasks
ns-mount
P = /mnt/empty

mount = tmpfs,/var,tmpfs,MS_NOSUID|MS_NODEV|MS_NOEXEC
mount = tmpfs,/run,tmpfs,MS_NOSUID|MS_NODEV|MS_NOEXEC
mount = /run/imageloader,/run/imageloader,none,MS_BIND|MS_REC|MS_NOSUID|MS_NODEV

bind-mount = /
bind-mount = /proc
bind-mount = /sys
bind-mount = /dev
bind-mount = /var/cache/camera
bind-mount = /var/lib/timezone
bind-mount = /dev/shm,,1
bind-mount = /var/lib/ml_core/opencl_cache
bind-mount = /run/perfetto,,1
bind-mount = /run/camera,,1
bind-mount = /run/camera_tokens/server
bind-mount = /usr/share/cros-camera/libfs
bind-mount = /run/udev/data
bind-mount = /run/chromeos-config/v1
bind-mount = /var/lib/metrics,,1
bind-mount = /run/dbus/

R = 13,40,40
n
S = /usr/share/policy/cros-camera-seccomp.policy
