# Copyright 2022 The ChromiumOS Authors
# Use of this source code is governed by a BSD-style license that can be
# found in the LICENSE file.

# For secagentd logs:
# - Log all messages to /var/log/secagentd.log.
# - Don't log them anywhere else.

template(name="LogWithoutHostname" type="string"
         string="%TIMESTAMP:1:26:date-rfc3339,date-utc%Z
         %syslogseverity-text:::uppercase%
         %syslogtag%%msg:::sp-if-no-1st-sp%%msg::drop-last-lf%\n")
module(load="builtin:omfile" Template="LogWithoutHostname")

if $programname == 'secagentd' then -/var/log/secagentd.log
& stop