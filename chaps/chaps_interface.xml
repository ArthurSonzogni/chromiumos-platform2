<?xml version="1.0" encoding="UTF-8" ?>

<!--
  Copyright (c) 2011 The Chromium OS Authors. All rights reserved.
  Use of this source code is governed by a BSD-style license that can be
  found in the LICENSE file.
-->

<!--
  This file defines the Chaps D-Bus interface. It can be used to generate
  glib bindings as follows:

     dbus-binding-tool -mode=glib-server -prefix=chaps chaps_interface.xml
                        &gt; bindings_server.h
-->

<!-- The DTD to help xmllint.
-->
<!DOCTYPE node PUBLIC
  "-//freedesktop//DTD D-Bus Object Introspection 1.0//EN"
  "http://standards.freedesktop.org/dbus/1.0/introspect.dtd">

<node name="/org/chromium/Chaps">
  <interface name="org.chromium.Chaps">

    <!-- Methods that map to PKCS #11 calls. Each method name is identical to
         the PKCS #11 function name except for the "C_" prefix.
    -->

    <!-- PKCS #11 v2.20 section 11.5 page 106. -->
    <method name="GetSlotList">
      <arg type="b" name="token_present" direction="in"/>
      <arg type="au" name="slot_list" direction="out"/>
      <arg type="u" name="result" direction="out">
        <annotation name="org.freedesktop.DBus.GLib.ReturnVal" value=""/>
      </arg>
    </method>

    <!-- PKCS #11 v2.20 section 11.5 page 108. -->
    <method name="GetSlotInfo">
      <arg type="u" name="slot_id" direction="in"/>
      <arg type="s" name="slot_description" direction="out"/>
      <arg type="s" name="manufacturer_id" direction="out"/>
      <arg type="u" name="flags" direction="out"/>
      <arg type="y" name="hardware_version_major" direction="out"/>
      <arg type="y" name="hardware_version_minor" direction="out"/>
      <arg type="y" name="firmware_version_major" direction="out"/>
      <arg type="y" name="firmware_version_minor" direction="out"/>
      <arg type="u" name="result" direction="out">
        <annotation name="org.freedesktop.DBus.GLib.ReturnVal" value=""/>
      </arg>
    </method>

    <!-- PKCS #11 v2.20 section 11.5 page 109. -->
    <method name="GetTokenInfo">
      <arg type="u" name="slot_id" direction="in"/>
      <arg type="s" name="label" direction="out"/>
      <arg type="s" name="manufacturer_id" direction="out"/>
      <arg type="s" name="model" direction="out"/>
      <arg type="s" name="serial_number" direction="out"/>
      <arg type="u" name="flags" direction="out"/>
      <arg type="u" name="max_session_count" direction="out"/>
      <arg type="u" name="session_count" direction="out"/>
      <arg type="u" name="max_session_count_rw" direction="out"/>
      <arg type="u" name="session_count_rw" direction="out"/>
      <arg type="u" name="max_pin_len" direction="out"/>
      <arg type="u" name="min_pin_len" direction="out"/>
      <arg type="u" name="total_public_memory" direction="out"/>
      <arg type="u" name="free_public_memory" direction="out"/>
      <arg type="u" name="total_private_memory" direction="out"/>
      <arg type="u" name="free_private_memory" direction="out"/>
      <arg type="y" name="hardware_version_major" direction="out"/>
      <arg type="y" name="hardware_version_minor" direction="out"/>
      <arg type="y" name="firmware_version_major" direction="out"/>
      <arg type="y" name="firmware_version_minor" direction="out"/>
      <arg type="u" name="result" direction="out">
        <annotation name="org.freedesktop.DBus.GLib.ReturnVal" value=""/>
      </arg>
    </method>

    <!-- PKCS #11 v2.20 section 11.5 page 111. -->
    <method name="GetMechanismList">
      <arg type="u" name="slot_id" direction="in"/>
      <arg type="au" name="mechanism_list" direction="out"/>
      <arg type="u" name="result" direction="out">
        <annotation name="org.freedesktop.DBus.GLib.ReturnVal" value=""/>
      </arg>
    </method>

    <!-- PKCS #11 v2.20 section 11.5 page 112. -->
    <method name="GetMechanismInfo">
      <arg type="u" name="slot_id" direction="in"/>
      <arg type="u" name="mechanism_type" direction="in"/>
      <arg type="u" name="min_key_size" direction="out"/>
      <arg type="u" name="max_key_size" direction="out"/>
      <arg type="u" name="flags" direction="out"/>
      <arg type="u" name="result" direction="out">
        <annotation name="org.freedesktop.DBus.GLib.ReturnVal" value=""/>
      </arg>
    </method>

    <!-- PKCS #11 v2.20 section 11.5 page 113. -->
    <method name="InitToken">
      <arg type="u" name="slot_id" direction="in"/>
      <arg type="b" name="use_null_pin" direction="in"/>
      <arg type="s" name="optional_so_pin" direction="in"/>
      <arg type="s" name="new_token_label" direction="in"/>
      <arg type="u" name="result" direction="out">
        <annotation name="org.freedesktop.DBus.GLib.ReturnVal" value=""/>
      </arg>
    </method>

    <!-- PKCS #11 v2.20 section 11.5 page 115. -->
    <method name="InitPIN">
      <arg type="u" name="session_id" direction="in"/>
      <arg type="b" name="use_null_pin" direction="in"/>
      <arg type="s" name="optional_user_pin" direction="in"/>
      <arg type="u" name="result" direction="out">
        <annotation name="org.freedesktop.DBus.GLib.ReturnVal" value=""/>
      </arg>
    </method>

    <!-- PKCS #11 v2.20 section 11.5 page 116. -->
    <method name="SetPIN">
      <arg type="u" name="session_id" direction="in"/>
      <arg type="b" name="use_null_old_pin" direction="in"/>
      <arg type="s" name="optional_old_pin" direction="in"/>
      <arg type="b" name="use_null_new_pin" direction="in"/>
      <arg type="s" name="optional_new_pin" direction="in"/>
      <arg type="u" name="result" direction="out">
        <annotation name="org.freedesktop.DBus.GLib.ReturnVal" value=""/>
      </arg>
    </method>

    <!-- PKCS #11 v2.20 section 11.6 page 117. -->
    <method name="OpenSession">
      <arg type="u" name="slot_id" direction="in"/>
      <arg type="u" name="flags" direction="in"/>
      <arg type="u" name="session_id" direction="out"/>
      <arg type="u" name="result" direction="out">
        <annotation name="org.freedesktop.DBus.GLib.ReturnVal" value=""/>
      </arg>
    </method>

    <!-- PKCS #11 v2.20 section 11.6 page 118. -->
    <method name="CloseSession">
      <arg type="u" name="session_id" direction="in"/>
      <arg type="u" name="result" direction="out">
        <annotation name="org.freedesktop.DBus.GLib.ReturnVal" value=""/>
      </arg>
    </method>

    <!-- PKCS #11 v2.20 section 11.6 page 120. -->
    <method name="CloseAllSessions">
      <arg type="u" name="slot_id" direction="in"/>
      <arg type="u" name="result" direction="out">
        <annotation name="org.freedesktop.DBus.GLib.ReturnVal" value=""/>
      </arg>
    </method>

    <!-- PKCS #11 v2.20 section 11.6 page 120. -->
    <method name="GetSessionInfo">
      <arg type="u" name="session_id" direction="in"/>
      <arg type="u" name="slot_id" direction="out"/>
      <arg type="u" name="state" direction="out"/>
      <arg type="u" name="flags" direction="out"/>
      <arg type="u" name="device_error" direction="out"/>
      <arg type="u" name="result" direction="out">
        <annotation name="org.freedesktop.DBus.GLib.ReturnVal" value=""/>
      </arg>
    </method>

    <!-- PKCS #11 v2.20 section 11.6 page 121. -->
    <method name="GetOperationState">
      <arg type="u" name="session_id" direction="in"/>
      <arg type="ay" name="operation_state" direction="out"/>
      <arg type="u" name="result" direction="out">
        <annotation name="org.freedesktop.DBus.GLib.ReturnVal" value=""/>
      </arg>
    </method>

    <!-- PKCS #11 v2.20 section 11.6 page 123. -->
    <method name="SetOperationState">
      <arg type="u" name="session_id" direction="in"/>
      <arg type="ay" name="operation_state" direction="in"/>
      <arg type="u" name="encryption_key_handle" direction="in"/>
      <arg type="u" name="authentication_key_handle" direction="in"/>
      <arg type="u" name="result" direction="out">
        <annotation name="org.freedesktop.DBus.GLib.ReturnVal" value=""/>
      </arg>
    </method>

    <!-- PKCS #11 v2.20 section 11.6 page 125. -->
    <method name="Login">
      <arg type="u" name="session_id" direction="in"/>
      <arg type="u" name="user_type" direction="in"/>
      <arg type="b" name="use_null_pin" direction="in"/>
      <arg type="s" name="optional_pin" direction="in"/>
      <arg type="u" name="result" direction="out">
        <annotation name="org.freedesktop.DBus.GLib.ReturnVal" value=""/>
      </arg>
    </method>

    <!-- PKCS #11 v2.20 section 11.6 page 127. -->
    <method name="Logout">
      <arg type="u" name="session_id" direction="in"/>
      <arg type="u" name="result" direction="out">
        <annotation name="org.freedesktop.DBus.GLib.ReturnVal" value=""/>
      </arg>
    </method>

    <!-- PKCS #11 v2.20 section 11.7 page 128. -->
    <method name="CreateObject">
      <arg type="u" name="session_id" direction="in"/>
      <arg type="ay" name="attributes" direction="in"/>
      <arg type="u" name="new_object_handle" direction="out"/>
      <arg type="u" name="result" direction="out">
        <annotation name="org.freedesktop.DBus.GLib.ReturnVal" value=""/>
      </arg>
    </method>

    <!-- PKCS #11 v2.20 section 11.7 page 130. -->
    <method name="CopyObject">
      <arg type="u" name="session_id" direction="in"/>
      <arg type="u" name="object_handle" direction="in"/>
      <arg type="ay" name="attributes" direction="in"/>
      <arg type="u" name="new_object_handle" direction="out"/>
      <arg type="u" name="result" direction="out">
        <annotation name="org.freedesktop.DBus.GLib.ReturnVal" value=""/>
      </arg>
    </method>

    <!-- PKCS #11 v2.20 section 11.7 page 131. -->
    <method name="DestroyObject">
      <arg type="u" name="session_id" direction="in"/>
      <arg type="u" name="object_handle" direction="in"/>
      <arg type="u" name="result" direction="out">
        <annotation name="org.freedesktop.DBus.GLib.ReturnVal" value=""/>
      </arg>
    </method>

    <!-- PKCS #11 v2.20 section 11.7 page 132. -->
    <method name="GetObjectSize">
      <arg type="u" name="session_id" direction="in"/>
      <arg type="u" name="object_handle" direction="in"/>
      <arg type="u" name="object_size" direction="out"/>
      <arg type="u" name="result" direction="out">
        <annotation name="org.freedesktop.DBus.GLib.ReturnVal" value=""/>
      </arg>
    </method>

    <!-- PKCS #11 v2.20 section 11.7 page 133. -->
    <method name="GetAttributeValue">
      <arg type="u" name="session_id" direction="in"/>
      <arg type="u" name="object_handle" direction="in"/>
      <arg type="ay" name="attributes_in" direction="in"/>
      <arg type="ay" name="attributes_out" direction="out"/>
      <arg type="u" name="result" direction="out">
        <annotation name="org.freedesktop.DBus.GLib.ReturnVal" value=""/>
      </arg>
    </method>

    <!-- PKCS #11 v2.20 section 11.7 page 135. -->
    <method name="SetAttributeValue">
      <arg type="u" name="session_id" direction="in"/>
      <arg type="u" name="object_handle" direction="in"/>
      <arg type="ay" name="attributes" direction="in"/>
      <arg type="u" name="result" direction="out">
        <annotation name="org.freedesktop.DBus.GLib.ReturnVal" value=""/>
      </arg>
    </method>

    <!-- PKCS #11 v2.20 section 11.7 page 136. -->
    <method name="FindObjectsInit">
      <arg type="u" name="session_id" direction="in"/>
      <arg type="ay" name="attributes" direction="in"/>
      <arg type="u" name="result" direction="out">
        <annotation name="org.freedesktop.DBus.GLib.ReturnVal" value=""/>
      </arg>
    </method>

    <!-- PKCS #11 v2.20 section 11.7 page 137. -->
    <method name="FindObjects">
      <arg type="u" name="session_id" direction="in"/>
      <arg type="u" name="max_object_count" direction="in"/>
      <arg type="au" name="object_list" direction="out"/>
      <arg type="u" name="result" direction="out">
        <annotation name="org.freedesktop.DBus.GLib.ReturnVal" value=""/>
      </arg>
    </method>

    <!-- PKCS #11 v2.20 section 11.7 page 138. -->
    <method name="FindObjectsFinal">
      <arg type="u" name="session_id" direction="in"/>
      <arg type="u" name="result" direction="out">
        <annotation name="org.freedesktop.DBus.GLib.ReturnVal" value=""/>
      </arg>
    </method>

    <!-- PKCS #11 v2.20 section 11.8 page 139. -->
    <method name="EncryptInit">
      <arg type="u" name="session_id" direction="in"/>
      <arg type="u" name="mechanism_type" direction="in"/>
      <arg type="ay" name="mechanism_parameter" direction="in"/>
      <arg type="u" name="key_handle" direction="in"/>
      <arg type="u" name="result" direction="out">
        <annotation name="org.freedesktop.DBus.GLib.ReturnVal" value=""/>
      </arg>
    </method>

    <!-- PKCS #11 v2.20 section 11.8 page 140. -->
    <method name="Encrypt">
      <arg type="u" name="session_id" direction="in"/>
      <arg type="ay" name="data_in" direction="in"/>
      <arg type="u" name="max_out_length" direction="in"/>
      <arg type="u" name="actual_out_length" direction="out"/>
      <arg type="ay" name="data_out" direction="out"/>
      <arg type="u" name="result" direction="out">
        <annotation name="org.freedesktop.DBus.GLib.ReturnVal" value=""/>
      </arg>
    </method>

    <!-- PKCS #11 v2.20 section 11.8 page 141. -->
    <method name="EncryptUpdate">
      <arg type="u" name="session_id" direction="in"/>
      <arg type="ay" name="data_in" direction="in"/>
      <arg type="u" name="max_out_length" direction="in"/>
      <arg type="u" name="actual_out_length" direction="out"/>
      <arg type="ay" name="data_out" direction="out"/>
      <arg type="u" name="result" direction="out">
        <annotation name="org.freedesktop.DBus.GLib.ReturnVal" value=""/>
      </arg>
    </method>

    <!-- PKCS #11 v2.20 section 11.8 page 141. -->
    <method name="EncryptFinal">
      <arg type="u" name="session_id" direction="in"/>
      <arg type="u" name="max_out_length" direction="in"/>
      <arg type="u" name="actual_out_length" direction="out"/>
      <arg type="ay" name="data_out" direction="out"/>
      <arg type="u" name="result" direction="out">
        <annotation name="org.freedesktop.DBus.GLib.ReturnVal" value=""/>
      </arg>
    </method>

    <!-- PKCS #11 v2.20 section 11.9 page 144. -->
    <method name="DecryptInit">
      <arg type="u" name="session_id" direction="in"/>
      <arg type="u" name="mechanism_type" direction="in"/>
      <arg type="ay" name="mechanism_parameter" direction="in"/>
      <arg type="u" name="key_handle" direction="in"/>
      <arg type="u" name="result" direction="out">
        <annotation name="org.freedesktop.DBus.GLib.ReturnVal" value=""/>
      </arg>
    </method>

    <!-- PKCS #11 v2.20 section 11.9 page 145. -->
    <method name="Decrypt">
      <arg type="u" name="session_id" direction="in"/>
      <arg type="ay" name="data_in" direction="in"/>
      <arg type="u" name="max_out_length" direction="in"/>
      <arg type="u" name="actual_out_length" direction="out"/>
      <arg type="ay" name="data_out" direction="out"/>
      <arg type="u" name="result" direction="out">
        <annotation name="org.freedesktop.DBus.GLib.ReturnVal" value=""/>
      </arg>
    </method>

    <!-- PKCS #11 v2.20 section 11.9 page 146. -->
    <method name="DecryptUpdate">
      <arg type="u" name="session_id" direction="in"/>
      <arg type="ay" name="data_in" direction="in"/>
      <arg type="u" name="max_out_length" direction="in"/>
      <arg type="u" name="actual_out_length" direction="out"/>
      <arg type="ay" name="data_out" direction="out"/>
      <arg type="u" name="result" direction="out">
        <annotation name="org.freedesktop.DBus.GLib.ReturnVal" value=""/>
      </arg>
    </method>

    <!-- PKCS #11 v2.20 section 11.9 page 146. -->
    <method name="DecryptFinal">
      <arg type="u" name="session_id" direction="in"/>
      <arg type="u" name="max_out_length" direction="in"/>
      <arg type="u" name="actual_out_length" direction="out"/>
      <arg type="ay" name="data_out" direction="out"/>
      <arg type="u" name="result" direction="out">
        <annotation name="org.freedesktop.DBus.GLib.ReturnVal" value=""/>
      </arg>
    </method>
  </interface>
</node>

